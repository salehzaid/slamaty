# โ ูุงุฆูุฉ ุงูุชุญูู ูููุดุฑ - ูุธุงู ุณูุงูุชู v2.0

## ๐ ูุจู ุงููุดุฑ

### 1. ุชุทุจูู Migration ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ๏ธ **ููู ุฌุฏุงู**

```bash
# ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุจูุงูุงุช ุงูุฅูุชุงุฌ
psql -h YOUR_PRODUCTION_HOST -U YOUR_DB_USER -d YOUR_DB_NAME

# ุชุทุจูู migration ุงูุฌุฏูุฏ
\i backend/migrations/002_add_evaluation_result_capa_fields.sql

# ุงูุชุญูู ูู ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ
\d evaluation_results

# ูุฌุจ ุฃู ุชุฑู:
# - needs_capa (boolean)
# - capa_note (text)

# ุงูุฎุฑูุฌ
\q
```

**ููุงุญุธุฉ:** ูุฐุง Migration ุขูู - ูุถูู ุฃุนูุฏุฉ ููุท ููุง ูุญุฐู ุฃู ุจูุงูุงุช ููุฌูุฏุฉ.

---

### 2. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ (Environment Variables)

#### ุฃ) ุงููุชุบูุฑุงุช ุงููุทููุจุฉ (Essential)

```bash
DATABASE_URL=postgresql://user:password@host:port/database
SECRET_KEY=your-very-secret-key-here-min-32-chars
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=43200
FRONTEND_URL=https://your-domain.com
```

#### ุจ) ุงููุชุบูุฑุงุช ุงูุงุฎุชูุงุฑูุฉ ููุจุฑูุฏ ุงูุฅููุชุฑููู (Optional - Email)

```bash
# ุฅุฐุง ููุช ุชุฑูุฏ ุฅุดุนุงุฑุงุช ุจุฑูุฏูุฉ
SMTP_SERVER=smtp.sendgrid.net
SMTP_PORT=587
SENDER_EMAIL=no-reply@yourdomain.com
SENDER_PASSWORD=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDER_NAME=ูุธุงู ุณูุงูุชู
```

**ููุงุญุธุฉ:** ุงููุธุงู ูุนูู ุจุฏูู SMTP (ุฅุดุนุงุฑุงุช ุฏุงุฎู ุงูุชุทุจูู ููุท).

---

### 3. ุนูู Railway (ุฅุฐุง ููุช ุชุณุชุฎุฏูู)

#### ุฃ) ุฅุถุงูุฉ ุงููุชุบูุฑุงุช

```bash
# ุนุจุฑ Railway CLI
railway variables set DATABASE_URL="postgresql://..."
railway variables set SECRET_KEY="your-secret-key"
railway variables set FRONTEND_URL="https://salamaty.app"

# ุฃู ุนุจุฑ Dashboard
# 1. ุงุฐูุจ ุฅูู ูุดุฑูุนู ูู Railway
# 2. ุงููุฑ ุนูู "Variables"
# 3. ุฃุถู ุงููุชุบูุฑุงุช ุฃุนูุงู
```

#### ุจ) ุชุทุจูู Migration

```bash
# ุทุฑููุฉ 1: ุนุจุฑ Railway CLI
railway run psql $DATABASE_URL -f backend/migrations/002_add_evaluation_result_capa_fields.sql

# ุทุฑููุฉ 2: ูู ูุดุฑูุนู ุงููุญูู
psql $RAILWAY_DATABASE_URL -f backend/migrations/002_add_evaluation_result_capa_fields.sql
```

#### ุฌ) Deploy

```bash
# ุณูุชู Deploy ุชููุงุฆูุงู ุจุนุฏ Push ุฅูู GitHub
# ุฃู ููููู ุงุณุชุฎุฏุงู:
railway up
```

---

### 4. ุงูุชุญูู ุจุนุฏ ุงููุดุฑ

#### ุฃ) ุตุญุฉ Backend

```bash
# ุชุญูู ูู ุตุญุฉ ุงูุฎุงุฏู
curl https://your-api-domain.com/health

# ุชุญูู ูู endpoint ุงูุฌุฏูุฏ (ูุชุทูุจ token)
curl https://your-api-domain.com/api/rounds/my/stats \
  -H "Authorization: Bearer YOUR_TOKEN"

# ูุฌุจ ุฃู ุชุฑู:
# {"total": X, "completed": X, "in_progress": X, ...}
```

#### ุจ) ุตุญุฉ Database

```bash
# ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
psql -h HOST -U USER -d DATABASE

# ุชุญูู ูู ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'evaluation_results' 
AND column_name IN ('needs_capa', 'capa_note');

# ุชุญูู ูู JSONB columns ูู rounds
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'rounds' 
AND column_name IN ('selected_categories', 'evaluation_items', 'assigned_to_ids');
# ูุฌุจ ุฃู ูููู data_type = 'jsonb'
```

#### ุฌ) ุตุญุฉ Frontend

```bash
# ุงูุชุญ ุงููููุน
open https://your-domain.com

# ุชุญูู ูู:
# 1. ุชุณุฌูู ุงูุฏุฎูู ูุนูู
# 2. ุตูุญุฉ "ุฌููุงุชู" ุชุนุฑุถ 8 ุจุทุงูุงุช ุฅุญุตุงุฆูุฉ
# 3. ูููุฐุฌ ุงูุชูููู ูุนุฑุถ ุฒุฑ "ุงุจุฏุฃ ุฎุทุฉ ุชุตุญูุญูุฉ" (ุนูุฏ #capa)
# 4. ุงูุฎุทูุท ููุญุฏุฉ (Noto Kufi Arabic)
```

---

## ๐งช ุงุฎุชุจุงุฑุงุช Post-Deployment

### 1. ุงุฎุชุจุงุฑ ูุธุงู ุงูุญุงูุฉ ุงูุชููุงุฆู

```sql
-- ูู ุจุชุญุฏูุซ ุชุงุฑูุฎ ุฌููุฉ ูุฌุนููุง ูุชุฃุฎุฑุฉ
UPDATE rounds 
SET deadline = NOW() - INTERVAL '2 days',
    status = 'in_progress'
WHERE id = 1;

-- ุงูุขู ุงูุชุญ ุตูุญุฉ "ุฌููุงุชู" ูู ุงููุชุตูุญ
-- ูุฌุจ ุฃู ุชุชุญูู ุงูุญุงูุฉ ุชููุงุฆูุงู ุฅูู 'overdue'
```

### 2. ุงุฎุชุจุงุฑ ุฅุญุตุงุฆูุงุช "ุฌููุงุชู"

1. ุณุฌู ุงูุฏุฎูู ููุณุชุฎุฏู ูุฏูู ุฌููุงุช
2. ุงุฐูุจ ุฅูู ุตูุญุฉ "ุฌููุงุชู"
3. ุชุญูู ูู:
   - โ 8 ุจุทุงูุงุช ุฅุญุตุงุฆูุฉ ุธุงูุฑุฉ
   - โ ุงูุฃุฑูุงู ุตุญูุญุฉ
   - โ ุฃุดุฑุทุฉ ุงูุชูุฏู ุชุนูู
   - โ ูุคุดุฑุงุช ุงูููุช (ุฃูุงู ูุชุจููุฉ/ูุชุฃุฎุฑุฉ) ุธุงูุฑุฉ

### 3. ุงุฎุชุจุงุฑ ูุธุงู CAPA

1. ุงูุชุญ ุฌููุฉ ููุชูููู
2. ุงุฎุชุฑ ุนูุตุฑ ูุงุถุจุท ุญุงูุชู ุนูู "ุบูุฑ ูุทุจู"
3. ุงูุชุจ ูู ุงูุชุนูููุงุช: "ุงููุซููุฉ ุบูุฑ ูุชููุฑุฉ #capa"
4. ุชุญูู ูู:
   - โ ุธููุฑ ุฒุฑ "ุงุจุฏุฃ ุฎุทุฉ ุชุตุญูุญูุฉ"
   - โ ุนูุฏ ุงูููุฑุ ูุชู ุฅูุดุงุก CAPA
   - โ ุงููุญุงููุฉ ุงูุซุงููุฉ ุชุฑุฌุน ููุณ CAPA (ููุน ุงูุชูุฑุงุฑ)

### 4. ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช

```sql
-- ุชุนููู CAPA ููุณุชุฎุฏู
UPDATE capas 
SET assigned_to_id = 1 
WHERE id = 1;

-- ุณุฌู ุงูุฏุฎูู ูุงููุณุชุฎุฏู ุฑูู 1
-- ุชุญูู ูู ูุฌูุฏ ุฅุดุนุงุฑ ุฌุฏูุฏ ูู ุงูุชุทุจูู
```

---

## ๐ ุงุณุชูุดุงู ุงููุดุงูู ุงููุญุชููุฉ

### ุงููุดููุฉ 1: ุฎุทุฃ "column does not exist"

**ุงูุณุจุจ:** Migration ูู ููุทุจู

**ุงูุญู:**
```bash
psql $DATABASE_URL -f backend/migrations/002_add_evaluation_result_capa_fields.sql
```

### ุงููุดููุฉ 2: ุงูุฅุญุตุงุฆูุงุช ุชุนุฑุถ ุฃุตูุงุฑ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. `assigned_to_ids` ูุงุฑุบ ูู ุงูุฌููุงุช
2. ุงููุณุชุฎุฏู ุบูุฑ ูุณูุฏ ูุฃู ุฌููุฉ

**ุงูุญู:**
```sql
-- ุชุญูู ูู assigned_to_ids
SELECT id, title, assigned_to_ids 
FROM rounds 
WHERE assigned_to_ids @> '[1]'::jsonb;  -- ุงุณุชุจุฏู 1 ุจู user_id

-- ุฅุฐุง ูุงู ูุงุฑุบุงูุ ุฃุถู ุงููุณุชุฎุฏู
UPDATE rounds 
SET assigned_to_ids = '[1]'::jsonb  -- ุฃู ุฃู user_id
WHERE id = YOUR_ROUND_ID;
```

### ุงููุดููุฉ 3: ุฒุฑ CAPA ูุง ูุธูุฑ

**ุงูุฃุณุจุงุจ:**
1. ุงูุญุงูุฉ ููุณุช "ุบูุฑ ูุทุจู" ุฃู "ุฌุฒุฆู"
2. ุงูุชุนููู ูุง ูุญุชูู ุนูู `#capa`

**ุงูุชุญูู:**
- ุชุฃูุฏ ูู ุงุฎุชูุงุฑ "ุบูุฑ ูุทุจู"
- ุงูุชุจ `#capa` ูู ุงูุชุนูููุงุช (ุจุงูุฃุญุฑู ุงูุฅูุฌููุฒูุฉ ุงูุตุบูุฑุฉ)

### ุงููุดููุฉ 4: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุง ููุฑุณู

**ุงูุณุจุจ:** SMTP ุบูุฑ ููุนุฏ

**ุงูุญู:**
- ุฅุฐุง ููุช ูุง ุชุญุชุงุฌ ุงูุจุฑูุฏุ ุชุฌุงูู ูุฐุง (ุงูุฅุดุนุงุฑุงุช ุฏุงุฎู ุงูุชุทุจูู ุชุนูู)
- ุฅุฐุง ููุช ุชุฑูุฏ ุงูุจุฑูุฏุ ุฑุงุฌุน `SMTP_SETUP_GUIDE.md`

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### Logs ุงููููุฉ ูููุชุงุจุนุฉ

```bash
# Railway logs
railway logs --tail 100

# ุชุตููุฉ ุฃุฎุทุงุก CAPA
railway logs | grep -i "capa\|error"

# ุชุตููุฉ ุชุญุฏูุซุงุช ุงูุญุงูุฉ
railway logs | grep -i "status.*updated"
```

### ุงุณุชุนูุงูุงุช ูููุฏุฉ

```sql
-- ุนุฏุฏ ุงูุฌููุงุช ุญุณุจ ุงูุญุงูุฉ
SELECT status, COUNT(*) 
FROM rounds 
GROUP BY status;

-- ุนุฏุฏ CAPA ุญุณุจ ุงูุญุงูุฉ
SELECT status, COUNT(*) 
FROM capas 
GROUP BY status;

-- ุฌููุงุช ูู ุชูุญุฏุซ ุญุงูุชูุง (ูุญุชููุฉ)
SELECT id, title, status, scheduled_date, deadline
FROM rounds
WHERE status = 'scheduled' 
  AND scheduled_date < NOW() - INTERVAL '1 day';

-- CAPA ูุชุฃุฎุฑุฉ
SELECT id, title, target_date, assigned_to_id
FROM capas
WHERE status IN ('pending', 'in_progress')
  AND target_date < NOW();
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

### ูุจู ุงููุดุฑ
- [ ] ุชู ุฏูุน ุงูููุฏ ุฅูู GitHub (โ ุชู)
- [ ] ุชู ุชุทุจูู Migration ูู ูุงุนุฏุฉ ุจูุงูุงุช Production
- [ ] ุชู ุฅุนุฏุงุฏ ุฌููุน Environment Variables ุงููุทููุจุฉ
- [ ] ุชู Deploy ุนูู Railway/Heroku/AWS

### ุจุนุฏ ุงููุดุฑ
- [ ] Backend ูุนูู ููุณุชุฌูุจ
- [ ] Frontend ููุญููู ุจุฏูู ุฃุฎุทุงุก
- [ ] ุชุณุฌูู ุงูุฏุฎูู ูุนูู
- [ ] ุตูุญุฉ "ุฌููุงุชู" ุชุนุฑุถ ุงูุฅุญุตุงุฆูุงุช ุงูู 8
- [ ] ูููุฐุฌ ุงูุชูููู ูุนุฑุถ ุฒุฑ CAPA
- [ ] ุงูุฎุทูุท ููุญุฏุฉ
- [ ] ูุง ุฃุฎุทุงุก ูู console ุงููุชุตูุญ
- [ ] ูุง ุฃุฎุทุงุก ูู logs ุงูุฎุงุฏู

### ุงุฎุชุจุงุฑุงุช ูุธูููุฉ
- [ ] ุงูุญุงูุฉ ุงูุชููุงุฆูุฉ ุชุนูู
- [ ] ุงูุฅุญุตุงุฆูุงุช ุฏูููุฉ
- [ ] ุฅูุดุงุก CAPA ูุนูู
- [ ] ููุน ุชูุฑุงุฑ CAPA ูุนูู
- [ ] ุงูุฅุดุนุงุฑุงุช ุชุธูุฑ (in-app)

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุจุนุฏ ุงููุดุฑ)

### ุฎูุงู 24 ุณุงุนุฉ
1. โ ุฑุงูุจ ุงูู logs ููุฃุฎุทุงุก
2. โ ุงุฌูุน ููุงุญุธุงุช ุงููุณุชุฎุฏููู ุงูุฃูุงุฆู
3. โ ุชุญูู ูู ุงูุฃุฏุงุก (ููุช ุงูุงุณุชุฌุงุจุฉ)

### ุฎูุงู ุฃุณุจูุน
1. โ ุฅุนุฏุงุฏ SMTP ุฅุฐุง ูุฒู ุงูุฃูุฑ
2. โ ุชุญุณูู ุฃู ูุดุงูู ูู UX
3. โ ุฅุถุงูุฉ ุจูุงูุงุช ุนููุฉ ุฅุถุงููุฉ (ุฅุฐุง ุงุญุชุงุฌ)

### ุฎุทุท ูุณุชูุจููุฉ (ุงุฎุชูุงุฑูุฉ)
- [ ] ููุญุฉ ุชุญูู ุชูุงุนููุฉ (charts)
- [ ] ุชุตุฏูุฑ ุชูุงุฑูุฑ PDF
- [ ] ุชุทุจูู ูุญููู
- [ ] ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ ูุจู ุงูููุงุนูุฏ

---

## ๐ ุงูุฏุนู

**ุฅุฐุง ูุงุฌูุช ูุดุงูู:**
1. ุฑุงุฌุน `COMPLETE_IMPLEMENTATION_SUMMARY.md`
2. ุฑุงุฌุน ุงูุชูุซูู ุงูููู ููููุฒุฉ ุงููุญุฏุฏุฉ
3. ุชุญูู ูู ุงูู logs
4. ุชุญูู ูู Database

**ุงููุซุงุฆู ุงููุฑุฌุนูุฉ:**
- `AUTOMATIC_STATUS_AND_STATS_API_DOCUMENTATION.md`
- `CAPA_SYSTEM_COMPLETE_DOCUMENTATION.md`
- `SMTP_SETUP_GUIDE.md`
- `PROJECT_STATUS.md`

---

## ๐ ุชูุงูููุง!

ุฅุฐุง ุฃูููุช ุฌููุน ุงูุฎุทูุงุช ุฃุนูุงูุ ูุฅู ูุธุงู ุณูุงูุชู v2.0 ุงูุขู:
- โ ููุดูุฑ ููุนูู
- โ ุฌููุน ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ูุดุทุฉ
- โ ููุฎุชุจุฑ ููุณุชูุฑ
- โ ููุซูู ุจุงููุงูู

**ุงุณุชูุชุน ุจุงููุธุงู ุงููุญุณูู! ๐**

---

**ุชุงุฑูุฎ ุงููุดุฑ:** 2025-10-11  
**ุงูุฅุตุฏุงุฑ:** 2.0  
**Git Commit:** cb34851

